(function(a){if(typeof define==="function"&&define.amd){define(["echarts","jquery"],a)}else{a(echarts,jquery)}}(function(q,y){function M(ag){var af=0,ae=ag.children,ad=ae&&ae.length;if(!ad){af=1}else{while(--ad>=0){af+=ae[ad].value}}ag.value=af}var a=function(){return this.eachAfter(M)};var G=function(aj){var ag=this,ah,af=[ag],ae,ad,ai;do{ah=af.reverse(),af=[];while(ag=ah.pop()){aj(ag),ae=ag.children;if(ae){for(ad=0,ai=ae.length;ad<ai;++ad){af.push(ae[ad])}}}}while(af.length);return this};var A=function(ah){var ag=this,ad=[ag],af,ae;while(ag=ad.pop()){ah(ag),af=ag.children;if(af){for(ae=af.length-1;ae>=0;--ae){ad.push(af[ae])}}}return this};var J=function(aj){var ah=this,ad=[ah],ag=[],af,ae,ai;while(ah=ad.pop()){ag.push(ah),af=ah.children;if(af){for(ae=0,ai=af.length;ae<ai;++ae){ad.push(af[ae])}}}while(ah=ag.pop()){aj(ah)}return this};var h=function(ad){return this.eachAfter(function(ah){var ag=+ad(ah.data)||0,af=ah.children,ae=af&&af.length;while(--ae>=0){ag+=af[ae].value}ah.value=ag})};var R=function(ad){return this.eachBefore(function(ae){if(ae.children){ae.children.sort(ad)}})};var D=function(ad){var ah=this,ag=v(ah,ad),af=[ah];while(ah!==ag){ah=ah.parent;af.push(ah)}var ae=af.length;while(ad!==ag){af.splice(ae,0,ad);ad=ad.parent}return af};function v(ag,ae){if(ag===ae){return ag}var af=ag.ancestors(),ad=ae.ancestors(),ah=null;ag=af.pop();ae=ad.pop();while(ag===ae){ah=ag;ag=af.pop();ae=ad.pop()}return ah}var Y=function(){var ae=this,ad=[ae];while(ae=ae.parent){ad.push(ae)}return ad};var w=function(){var ad=[];this.each(function(ae){ad.push(ae)});return ad};var X=function(){var ad=[];this.eachBefore(function(ae){if(!ae.children){ad.push(ae)}});return ad};var V=function(){var ad=this,ae=[];ad.each(function(af){if(af!==ad){ae.push({source:af.parent,target:af})}});return ae};function f(aj,af){var am=new r(aj),ak=+aj.value&&(am.value=aj.value),ah,ad=[am],ae,al,ai,ag;if(af==null){af=o}while(ah=ad.pop()){if(ak){ah.value=+ah.data.value}if((al=af(ah.data))&&(ag=al.length)){ah.children=new Array(ag);for(ai=ag-1;ai>=0;--ai){ad.push(ae=ah.children[ai]=new r(al[ai]));ae.parent=ah;ae.depth=ah.depth+1}}}return am.eachBefore(I)}function U(){return f(this).eachBefore(t)}function o(ad){return ad.children}function t(ad){ad.data=ad.data.data}function I(ae){var ad=0;do{ae.height=ad}while((ae=ae.parent)&&(ae.height<++ad))}function r(ad){this.data=ad;this.depth=this.height=0;this.parent=null}r.prototype=f.prototype={constructor:r,count:a,each:G,eachAfter:J,eachBefore:A,sum:h,sort:R,path:D,ancestors:Y,descendants:w,leaves:X,links:V,copy:U};function aa(ad){this._=ad;this.next=null;this.previous=null}function m(al){if(!(ae=al.length)){return 0}var ao,an,am,ae,ad,ah,ak,aj,ag,ai,af;ao=al[0],ao.x=0,ao.y=0;if(!(ae>1)){return ao.r}an=al[1],ao.x=-an.r,an.x=ao.r,an.y=0;if(!(ae>2)){return ao.r+an.r}c(an,ao,am=al[2]);ao=new aa(ao),an=new aa(an),am=new aa(am);ao.next=am.previous=an;an.next=ao.previous=am;am.next=an.previous=ao;pack:for(ak=3;ak<ae;++ak){c(ao._,an._,am=al[ak]),am=new aa(am);aj=an.next,ag=ao.previous,ai=an._.r,af=ao._.r;do{if(ai<=af){if(j(aj._,am._)){an=aj,ao.next=an,an.previous=ao,--ak;continue pack}ai+=aj._.r,aj=aj.next}else{if(j(ag._,am._)){ao=ag,ao.next=an,an.previous=ao,--ak;continue pack}af+=ag._.r,ag=ag.previous}}while(aj!==ag.next);am.previous=ao,am.next=an,ao.next=an.previous=an=am;ad=b(ao);while((am=am.next)!==an){if((ah=b(am))<ad){ao=am,ad=ah}}an=ao.next}ao=[an._],am=an;while((am=am.next)!==an){ao.push(am._)}am=N(ao);for(ak=0;ak<ae;++ak){ao=al[ak],ao.x-=am.x,ao.y-=am.y}return am.r}var P=function(ad){m(ad);return ad};function e(ad){return ad==null?null:n(ad)}function n(ad){if(typeof ad!=="function"){throw new Error}return ad}function Q(){return 0}var p=function(ad){return function(){return ad}};function s(ad){return Math.sqrt(ad.value)}function O(){var ad=null,af=1,ae=1,ah=Q;function ag(ai){ai.x=af/2,ai.y=ae/2;if(ad){ai.eachBefore(K(ad)).eachAfter(B(ah,0.5)).eachBefore(x(Math.min(af,ae)/(2*ai.r)))}else{ai.eachBefore(K(s)).eachAfter(B(Q,1)).eachAfter(B(ah,ai.r/Math.min(af,ae))).eachBefore(x(Math.min(af,ae)/(2*ai.r)))}return ai}ag.radius=function(ai){return arguments.length?(ad=e(ai),ag):ad};ag.size=function(ai){return arguments.length?(af=+ai[0],ae=+ai[1],ag):[af,ae]};ag.padding=function(ai){return arguments.length?(ah=typeof ai==="function"?ai:p(+ai),ag):ah};return ag}function K(ad){return function(ae){if(!ae.children){ae.r=Math.max(0,+ad(ae)||0)}}}function B(ae,ad){return function(ai){if(ag=ai.children){var ag,af,ak=ag.length,ah=ae(ai)*ad||0,aj;if(ah){for(af=0;af<ak;++af){ag[af].r+=ah}}aj=m(ag);if(ah){for(af=0;af<ak;++af){ag[af].r-=ah}}ai.r=aj+ah}}}function x(ad){return function(af){var ae=af.parent;af.r*=ad;if(ae){af.x=ae.x+ad*af.x;af.y=ae.y+ad*af.y}}}function c(ai,ag,ae){var ad=ai.x,am=ai.y,an=ag.r+ae.r,al=ai.r+ae.r,ao=ag.x-ad,ak=ag.y-am,aj=ao*ao+ak*ak;if(aj){var ah=0.5+((al*=al)-(an*=an))/(2*aj),af=Math.sqrt(Math.max(0,2*an*(al+aj)-(al-=aj)*al-an*an))/(2*aj);ae.x=ad+ah*ao+af*ak;ae.y=am+ah*ak-af*ao}else{ae.x=ad+al;ae.y=am}}function j(af,ad){var ag=ad.x-af.x,ae=ad.y-af.y,ah=af.r+ad.r;return ah*ah-0.000001>ag*ag+ae*ae}function b(ah){var af=ah._,ad=ah.next._,ai=af.r+ad.r,ag=(af.x*ad.r+ad.x*af.r)/ai,ae=(af.y*ad.r+ad.y*af.r)/ai;return ag*ag+ae*ae}var N=function(ag){var ad=0,ai=(ag=u(Z.call(ag))).length,ah=[],af,ae;while(ad<ai){af=ag[ad];if(ae&&T(ae,af)){++ad}else{ae=d(ah=g(ah,af)),ad=0}}return ae};function g(ag,af){var ae,ad;if(L(af,ag)){return[af]}for(ae=0;ae<ag.length;++ae){if(l(af,ag[ae])&&L(F(ag[ae],af),ag)){return[ag[ae],af]}}for(ae=0;ae<ag.length-1;++ae){for(ad=ae+1;ad<ag.length;++ad){if(l(F(ag[ae],ag[ad]),af)&&l(F(ag[ae],af),ag[ad])&&l(F(ag[ad],af),ag[ae])&&L(E(ag[ae],ag[ad],af),ag)){return[ag[ae],ag[ad],af]}}}throw new Error}function l(af,ad){var ah=af.r-ad.r,ag=ad.x-af.x,ae=ad.y-af.y;return ah<0||ah*ah<ag*ag+ae*ae}function T(af,ad){var ah=af.r-ad.r+0.000001,ag=ad.x-af.x,ae=ad.y-af.y;return ah>0&&ah*ah>ag*ag+ae*ae}function L(ad,af){for(var ae=0;ae<af.length;++ae){if(!T(ad,af[ae])){return false}}return true}function d(ad){switch(ad.length){case 1:return H(ad[0]);case 2:return F(ad[0],ad[1]);case 3:return E(ad[0],ad[1],ad[2])}}function H(ad){return{x:ad.x,y:ad.y,r:ad.r}}function F(ao,al){var ae=ao.x,an=ao.y,ag=ao.r,ad=al.x,ak=al.y,af=al.r,aj=ad-ae,am=ak-an,ah=af-ag,ai=Math.sqrt(aj*aj+am*am);return{x:(ae+ad+aj/ai*ah)/2,y:(an+ak+am/ai*ah)/2,r:(ai+ag+af)/2}}function E(aC,aA,az){var ay=aC.x,ah=aC.y,au=aC.r,ax=aA.x,ag=aA.y,ar=aA.r,av=az.x,ae=az.y,aq=az.r,aF=ay-ax,aD=ay-av,aj=ah-ag,ai=ah-ae,ap=ar-au,ao=aq-au,aH=ay*ay+ah*ah-au*au,aG=aH-ax*ax-ag*ag+ar*ar,aE=aH-av*av-ae*ae+aq*aq,aB=aD*aj-aF*ai,aw=(aj*aE-ai*aG)/(aB*2)-ay,at=(ai*ap-aj*ao)/aB,af=(aD*aG-aF*aE)/(aB*2)-ah,ad=(aF*ao-aD*ap)/aB,an=at*at+ad*ad-1,am=2*(au+aw*at+af*ad),al=aw*aw+af*af-au*au,ak=-(an?(am+Math.sqrt(am*am-4*an*al))/(2*an):al/am);return{x:ay+aw+at*ak,y:ah+af+ad*ak,r:ak}}var Z=Array.prototype.slice;function u(ag){var ad=ag.length,af,ae;while(ad){ae=Math.random()*ad--|0;af=ag[ad];ag[ad]=ag[ae];ag[ae]=af}return ag}q.util.hierarchy=f;q.util.pack=O;function ab(ag,ad,af){var ae=q.init(ad);S(ae,i(ag,ad),af);C(ae)}function i(ak,af){var aj=af.clientWidth;var ad=af.clientHeight;var ai=q.util.pack().size([aj,ad]).padding(1);var ah=0;var ag=["#1f77b4","#aec7e8","#ff7f0e","#ffbb78","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5","#8c564b","#c49c94","#e377c2","#f7b6d2","#7f7f7f","#c7c7c7","#bcbd22","#dbdb8d","#17becf","#9edae5"];var ae=q.util.hierarchy({children:ak}).sum(function(al){return al.value}).each(function(al){al.color=ag[ah%20];ah++;return al.color});return ai(ae).leaves()}function S(af,ah,ae){var ad={tooltip:{show:true,triggerOn:"none",formatter:function(ak){var aj=ak.textStyle||{};var ai=aj.fontSize||14;return'<span  style="border-radius: 6px;width: 12px;height: 12px;display: inline-block;background-color:'+ak.color+";font-size:"+ai+'px;"></span>'+" "+ak.data.name+":  "+ak.data.value}},graphic:z(ah,af,ae),series:[]};var ag=y.extend(true,{},ad,ae);af.setOption(ag)}function z(af,ae,ad){return q.util.map(af,function(ah,ag){return{type:"group",id:"circleGroup"+ag,bounding:"raw",color:ah.color,option:ad,data:ah.data,children:W(ah,ag,ae,ad),onmousemove:function(ai){ac.call(this,ai,ae)},onmouseout:function(ai){k.call(this,ai,ae)}}})}function W(ai,af,ah,ag){var ae=[];ae.push({id:"circle"+af,type:"circle",shape:{cx:ai.x,cy:ai.y,r:ai.r},name:"mainElem",style:{fill:ai.color},eventData:{id:"circle"+af},onclick:ad});var ak=ai.data.name.length>4?ai.data.name.substr(0,4):ai.data.name;var aj=y.extend({},{fill:"#fff",text:"    "+ak,textAlign:"center",textVerticalAlign:"middle",x:ai.x-ai.r/4,y:ai.y},ag.textStyle);ae.push({type:"text",style:aj,value:ai.value});return ae;function ad(){var al=new q.graphic.Circle({shape:this.shape,style:{stroke:"green",fill:null,lineWidth:2}});this.parent.add(al);ah.addClickElem(al)}}function ac(af,ad){var ae=this.option.tooltip||{};var ag=ae.textStyle||{};ad.dispatchAction({type:"showTip",x:af.offsetX,y:af.offsetY,tooltip:{formatterParams:{color:this.color,textStyle:ag,data:this.data}}});this.childOfName("mainElem").setStyle({stroke:"green",lineWidth:2})}function k(ae,ad){ad.dispatchAction({type:"hideTip"});this.childOfName("mainElem").setStyle({stroke:null})}function C(ad){ad.addClickElem=function(ae){if(this.currentElem!==ae&&this.currentElem!=null){this.currentElem.parent.remove(this.currentElem)}this.currentElem=ae};ad._zr.on("click",function(ae){if(ae.target==null){if(ad.currentElem!=null){ad.currentElem.parent.remove(ad.currentElem);ad.currentElem=null}}});document.onclick=function(ae){if(ae.toElement.tagName!="CANVAS"){if(ad.currentElem!=null){ad.currentElem.parent.remove(ad.currentElem);ad.currentElem=null}}}}window.renderBubbleChart=ab;return ab}));